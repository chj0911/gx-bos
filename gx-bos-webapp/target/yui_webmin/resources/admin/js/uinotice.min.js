function FileProgress(c,d){this.fileProgressID=c.id;this.file=c;this.opacity=100;this.height=0;this.fileProgressWrapper=$("#"+this.fileProgressID);if(!this.fileProgressWrapper.length){this.fileProgressWrapper=$("<tr></tr>");var n=this.fileProgressWrapper;n.attr("id",this.fileProgressID).addClass("progressContainer");var f=$("<td/>");f.addClass("progressName").text(c.name);var e=plupload.formatSize(c.size).toUpperCase();var g=$("<td/>");g.addClass("progressFileSize").text(e);var k=$('<td><a style="color:blue" href=# onclick="javascript:deleteUpload(\''+this.fileProgressID+"');setDeleteValue('"+c.name+"');\" >删除</a></td>");k.addClass("text-center");var l=$("<td/>");var b=$("<div/>");b.addClass("info");var a=$("<div/>");a.addClass("progress progress-striped");var h=$("<div/>");h.addClass("progress-bar progress-bar-info").attr("role","progressbar").attr("aria-valuemax",100).attr("aria-valuenow",0).attr("aria-valuein",0).width("0%");var i=$("<span class=sr-only />");i.text(e);var j=$("<a href=# />");j.hide().addClass("progressCancel").text("");h.append(i);a.append(h);b.append(a);b.append(j);var m=$('<div class="status text-center"/>');b.append(m);l.append(b);n.append(f);n.append(g);n.append(l);n.append(k);$("#"+d).append(n)}else{this.reset()}this.height=this.fileProgressWrapper.offset().top;this.setTimer(null);this.checkRemove(this.fileProgressID)}function deleteUpload(a){if($("#"+a).attr("isRemoveFile")==1){$("#"+a).remove()}else{ModalBox.alert("正在上传中，无法删除")}}function setDeleteValue(d){var c=$("#deleteFileName").val();if(c==null||c==""){$("#deleteFileName").val(d)}else{c+=(","+d);$("#deleteFileName").val(c)}var a=$("#fileNum").val();var b;b=parseInt(a)-1;$("#fileNum").val(b);if(b<=0){$("#fileListDiv").hide()}}FileProgress.prototype.checkRemove=function(a){if(this.file.status!==plupload.DONE){$("#"+a).attr("isRemoveFile",0)}else{$("#"+a).attr("isRemoveFile",1)}};FileProgress.prototype.setTimer=function(a){this.fileProgressWrapper.FP_TIMER=a};FileProgress.prototype.getTimer=function(a){return this.fileProgressWrapper.FP_TIMER||null};FileProgress.prototype.reset=function(){this.fileProgressWrapper.attr("class","progressContainer");this.fileProgressWrapper.find("td .progress .progress-bar-info").attr("aria-valuenow",0).width("0%").find("span").text("");this.appear()};FileProgress.prototype.setChunkProgess=function(j){var k=Math.ceil(this.file.size/j);if(k===1){return false}var c="";var f=$('<tr class="chunk-status-tr"><td colspan=3></td></tr>');var g=$("<div/>");for(var d=1;d<=k;d++){var b=$('<div class="col-md-2"/>');var a=$('<div class="progress progress-striped"></div>');var e=$("<div/>");e.addClass("progress-bar progress-bar-info text-left").attr("role","progressbar").attr("aria-valuemax",100).attr("aria-valuenow",0).attr("aria-valuein",0).width("0%").attr("id",this.file.id+"_"+d).text("");var h=$("<span/>");h.addClass("chunk-status").text();a.append(e);a.append(h);b.append(a);g.append(b)}this.fileProgressWrapper.find("td>div").append(c);f.hide().find("td").append(g);f.insertAfter(this.fileProgressWrapper)};FileProgress.prototype.setProgress=function(p,e,o){this.fileProgressWrapper.attr("class","progressContainer green");var f=this.file;var b=f.loaded;var q=plupload.formatSize(b).toUpperCase();var l=plupload.formatSize(e).toUpperCase();var h=this.fileProgressWrapper.find("td .progress").find(".progress-bar-info");this.fileProgressWrapper.find(".status").text("已上传: "+q+" 上传速度： "+l+"/s");p=parseInt(p,10);if(f.status!==plupload.DONE&&p===100){p=99}h.attr("aria-valuenow",p).css("width",p+"%");if(o){var n=Math.ceil(f.size/o);if(n===1){return false}var d=Math.ceil(b/o);var k,m;for(var i=0;i<d;i++){k=$("#"+f.id+"_"+i);k.width("100%").removeClass().addClass("alert-success").attr("aria-valuenow",100);m="块"+i+"上传进度100%";k.next().html(m)}var g=$("#"+f.id+"_"+d);var j;if(d<n){if(b%o){j=((b%o)/o*100).toFixed(2)}else{j=100;g.removeClass().addClass("alert-success")}}else{var c=f.size-o*(n-1);var a=f.size-b;if(a%c){j=((b%o)/c*100).toFixed(2)}else{j=100;g.removeClass().addClass("alert-success")}}g.width(j+"%");g.attr("aria-valuenow",j);m="块"+d+"上传进度"+j+"%";g.next().html(m)}this.appear()};FileProgress.prototype.setComplete=function(a,c){var e=this.fileProgressWrapper.find("td:eq(2) .progress");var b=c;if(c.length>50){b=c.substring(0,50)+"..."}var d="<div><a style='color: blue;' href="+c+" target='_blank' > "+b+"</a></div>";e.html(d).removeClass().next().next(".status").hide()};FileProgress.prototype.setError=function(){this.fileProgressWrapper.find("td:eq(2)").attr("class","text-warning");this.fileProgressWrapper.find("td:eq(2) .progress").css("width",0).hide();this.fileProgressWrapper.find("button").hide();this.fileProgressWrapper.next(".chunk-status-tr").hide()};FileProgress.prototype.setCancelled=function(b){var a="progressContainer";if(!b){a+=" red"}this.fileProgressWrapper.attr("class",a);this.fileProgressWrapper.find("td .progress .progress-bar-info").css("width",0)};FileProgress.prototype.setStatus=function(b,a){if(!a){this.fileProgressWrapper.find(".status").text(b).attr("class","status text-left")}};FileProgress.prototype.appear=function(){if(this.getTimer()!==null){clearTimeout(this.getTimer());this.setTimer(null)}if(this.fileProgressWrapper[0].filters){try{this.fileProgressWrapper[0].filters.item("DXImageTransform.Microsoft.Alpha").opacity=100}catch(a){this.fileProgressWrapper.css("filter","progid:DXImageTransform.Microsoft.Alpha(opacity=100)")}}else{this.fileProgressWrapper.css("opacity",1)}this.fileProgressWrapper.css("height","");this.height=this.fileProgressWrapper.offset().top;this.opacity=100;this.fileProgressWrapper.show()};