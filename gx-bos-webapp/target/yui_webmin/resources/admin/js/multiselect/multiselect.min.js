if(typeof jQuery==="undefined"){throw new Error("multiselect requires jQuery")}(function(b){var a=b.fn.jquery.split(" ")[0].split(".");if(a[0]<2&&a[1]<7){throw new Error("multiselect requires jQuery version 1.7 or higher")}})(jQuery);(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{a(jQuery)}}(function(e){var d=false;var b=(function(g){function f(h,i){var j=h.prop("id");this.$left=h;this.$right=g(i.right).length?g(i.right):g("#"+j+"_to");this.actions={$leftAll:g(i.leftAll).length?g(i.leftAll):g("#"+j+"_leftAll"),$rightAll:g(i.rightAll).length?g(i.rightAll):g("#"+j+"_rightAll"),$leftSelected:g(i.leftSelected).length?g(i.leftSelected):g("#"+j+"_leftSelected"),$rightSelected:g(i.rightSelected).length?g(i.rightSelected):g("#"+j+"_rightSelected"),$undo:g(i.undo).length?g(i.undo):g("#"+j+"_undo"),$redo:g(i.redo).length?g(i.redo):g("#"+j+"_redo")};delete i.leftAll;delete i.leftSelected;delete i.right;delete i.rightAll;delete i.rightSelected;this.options={keepRenderingSort:i.keepRenderingSort,submitAllLeft:i.submitAllLeft!==undefined?i.submitAllLeft:true,submitAllRight:i.submitAllRight!==undefined?i.submitAllRight:true,search:i.search,ignoreDisabled:i.ignoreDisabled!==undefined?i.ignoreDisabled:false};delete i.keepRenderingSort,i.submitAllLeft,i.submitAllRight,i.search,i.ignoreDisabled;this.callbacks=i;this.init()}f.prototype={undoStack:[],redoStack:[],init:function(){var h=this;if(h.$left.find("optgroup").length||h.$right.find("optgroup").length){h.callbacks.sort=false;h.options.search=false}if(h.options.keepRenderingSort){h.skipInitSort=true;h.callbacks.sort=function(j,i){return g(j).data("position")>g(i).data("position")?1:-1};h.$left.find("option").each(function(i,j){g(j).data("position",i)});h.$right.find("option").each(function(i,j){g(j).data("position",i)})}if(typeof h.callbacks.startUp=="function"){h.callbacks.startUp(h.$left,h.$right)}if(!h.skipInitSort&&typeof h.callbacks.sort=="function"){h.$left.mSort(h.callbacks.sort);h.$right.each(function(k,j){g(j).mSort(h.callbacks.sort)})}if(h.options.search&&h.options.search.left){h.options.search.$left=g(h.options.search.left);h.$left.before(h.options.search.$left)}if(h.options.search&&h.options.search.right){h.options.search.$right=g(h.options.search.right);h.$right.before(g(h.options.search.$right))}h.events()},events:function(){var h=this;if(h.options.search&&h.options.search.$left){h.options.search.$left.on("keyup",function(k){if(this.value){var i=h.$left.find('option:search("'+this.value+'")').mShow();var j=h.$left.find('option:not(:search("'+this.value+'"))').mHide()}else{h.$left.find("option").mShow()}})}if(h.options.search&&h.options.search.$right){h.options.search.$right.on("keyup",function(k){if(this.value){var i=h.$right.find('option:search("'+this.value+'")').mShow();var j=h.$right.find('option:not(:search("'+this.value+'"))').mHide()}else{h.$right.find("option").mShow()}})}h.$right.closest("form").on("submit",function(i){h.$left.find("option").prop("selected",h.options.submitAllLeft);h.$right.find("option").prop("selected",h.options.submitAllRight)});h.$left.on("dblclick","option",function(k){k.preventDefault();var j=false;if(d){j=h.checkDataFunc(d,k)}if(!j){var i=h.$left.find("option:selected");if(i.length){h.moveToRight(i,k)}}});h.$right.on("dblclick","option",function(j){j.preventDefault();var i=h.$right.find("option:selected");if(i.length){h.moveToLeft(i,j)}});if(navigator.userAgent.match(/MSIE/i)||navigator.userAgent.indexOf("Trident/")>0||navigator.userAgent.indexOf("Edge/")>0){h.$left.dblclick(function(i){h.actions.$rightSelected.trigger("click")});h.$right.dblclick(function(i){h.actions.$leftSelected.trigger("click")})}h.actions.$rightSelected.on("click",function(k){k.preventDefault();var j=false;if(d){j=h.checkDataFunc(d,k)}if(!j){var i=h.$left.find("option:selected");if(i.length){h.moveToRight(i,k)}}g(this).blur()});h.actions.$leftSelected.on("click",function(j){j.preventDefault();var i=h.$right.find("option:selected");if(i.length){h.moveToLeft(i,j)}g(this).blur()});h.actions.$rightAll.on("click",function(j){j.preventDefault();var i=h.$left.children(":not(span):not(.hidden)");if(i.length){h.moveToRight(i,j)}g(this).blur()});h.actions.$leftAll.on("click",function(j){j.preventDefault();var i=h.$right.children(":not(span):not(.hidden)");if(i.length){h.moveToLeft(i,j)}g(this).blur()});h.actions.$undo.on("click",function(i){i.preventDefault();h.undo(i)});h.actions.$redo.on("click",function(i){i.preventDefault();h.redo(i)})},checkDataFunc:function(j,k){var h=this;if(j){var l=h.$left.find("option:selected");console.log("left"+l.length);var i=h.$right.find("option");if(i.length>=1||l.length>1){ModalBox.alert("当前操作只能选择一个选项!");return true}return false}},moveToRight:function(h,k,j,l){var i=this;if(typeof i.callbacks.moveToRight=="function"){return i.callbacks.moveToRight(i,h,k,j,l)}else{if(typeof i.callbacks.beforeMoveToRight=="function"&&!j){if(!i.callbacks.beforeMoveToRight(i.$left,i.$right,h)){return false}}h.each(function(n,o){var q=g(o);if(i.options.ignoreDisabled&&q.is(":disabled")){return true}if(q.parent().is("optgroup")){var p=q.parent();var m=i.$right.find('optgroup[label="'+p.prop("label")+'"]');if(!m.length){m=p.clone();m.children().remove()}q=m.append(q);p.removeIfEmpty()}i.$right.move(q)});if(!l){i.undoStack.push(["right",h]);i.redoStack=[]}if(typeof i.callbacks.sort=="function"&&!j){i.$right.mSort(i.callbacks.sort)}if(typeof i.callbacks.afterMoveToRight=="function"&&!j){i.callbacks.afterMoveToRight(i.$left,i.$right,h)}return i}},moveToLeft:function(h,k,j,l){var i=this;if(typeof i.callbacks.moveToLeft=="function"){return i.callbacks.moveToLeft(i,h,k,j,l)}else{if(typeof i.callbacks.beforeMoveToLeft=="function"&&!j){if(!i.callbacks.beforeMoveToLeft(i.$left,i.$right,h)){return false}}h.each(function(n,o){var q=g(o);if(q.is("optgroup")||q.parent().is("optgroup")){var m=q.is("optgroup")?q:q.parent();var p=i.$left.find('optgroup[label="'+m.prop("label")+'"]');if(!p.length){p=m.clone();p.children().remove()}q=p.append(q.is("optgroup")?q.children():q);m.removeIfEmpty()}i.$left.move(q)});if(!l){i.undoStack.push(["left",h]);i.redoStack=[]}if(typeof i.callbacks.sort=="function"&&!j){i.$left.mSort(i.callbacks.sort)}if(typeof i.callbacks.afterMoveToLeft=="function"&&!j){i.callbacks.afterMoveToLeft(i.$left,i.$right,h)}return i}},undo:function(j){var h=this;var i=h.undoStack.pop();if(i){h.redoStack.push(i);switch(i[0]){case"left":h.moveToRight(i[1],j,false,true);break;case"right":h.moveToLeft(i[1],j,false,true);break}}},redo:function(j){var h=this;var i=h.redoStack.pop();if(i){h.undoStack.push(i);switch(i[0]){case"left":h.moveToLeft(i[1],j,false,true);break;case"right":h.moveToRight(i[1],j,false,true);break}}}};return f})(e);e.multiselect={defaults:{startUp:function(g,f){f.find("option").each(function(h,i){var k=g.find('option[value="'+i.value+'"]');var j=k.parent();k.remove();if(j.prop("tagName")=="OPTGROUP"){j.removeIfEmpty()}})},beforeMoveToRight:function(h,g,f){return true},afterMoveToRight:function(h,g,f){},beforeMoveToLeft:function(h,g,f){return true},afterMoveToLeft:function(h,g,f){},sort:function(g,f){if(g.innerHTML=="NA"){return 1}else{if(f.innerHTML=="NA"){return -1}}return(g.innerHTML>f.innerHTML)?1:-1}}};var a=window.navigator.userAgent;var c=(a.indexOf("MSIE ")+a.indexOf("Trident/")+a.indexOf("Edge/"))>-3;e.fn.multiselect=function(f){return this.each(function(){var i=e(this),h=i.data();var g=e.extend({},e.multiselect.defaults,h,f);if(f){d=f}return new b(i,g)})};e.fn.move=function(f){this.append(f).find("option").prop("selected",false);return this};e.fn.removeIfEmpty=function(){if(!this.children().length){this.remove()}return this};e.fn.mShow=function(){this.removeClass("hidden").show();if(c){this.each(function(f,g){if(e(g).parent().is("span")){e(g).parent().replaceWith(g)}e(g).show()})}return this};e.fn.mHide=function(){this.addClass("hidden").hide();if(c){this.each(function(f,g){if(!e(g).parent().is("span")){e(g).wrap("<span>").hide()}})}return this};e.fn.mSort=function(f){this.find("option").sort(f).appendTo(this);return this};e.expr[":"].search=e.expr.createPseudo(function(f){return function(g){return e(g).text().toUpperCase().indexOf(f.toUpperCase())>=0}})}));