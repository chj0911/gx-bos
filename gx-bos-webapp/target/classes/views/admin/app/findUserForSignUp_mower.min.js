var closeMyAssign=function(){var f=$("#myUserTable"),b;var e=$("#myAssignId").val(),g=$("#myAssignType").val(),h=$("#parentTableId").val();var j=f.DataTable().selectedRows();if(!j||j.length==0){ModalBox.alert("请选择一条数据");return}var c=new Array();if(g=="signUpTrain"){for(var d=0;d<j.length;d++){c.push({nameStr:j[d].name,username:j[d].userName,sex:j[d].sex,cardNo:j[d].cardNo,rank:j[d].rank,officePost:j[d].officePost,mobile:j[d].mobile})}b={userNames:c,id:$("#signUpId").val()}}else{for(var d=0;d<j.length;d++){c.push(j[d].userName)}b={userNames:c,id:e}}var a=base;var a="/admin/usercenter/"+g+"/saveuser";if(g=="user"){$("#leaderAccount").val(j[0].userName);$("#myAssignModal").modal("hide");return}if(g=="signUpTrain"){a="/eln/admin/signUp/train/saveUser";$.ajax({type:"post",url:a,data:JSON.stringify(b),dataType:"json",contentType:"application/json;charset=utf-8",success:function(i){$("#myAssignModal").modal("hide");if(h){$("#"+h).DataTable().ajax.reload()}}})}else{$.ajax({type:"post",url:a,data:JSON.stringify(b),dataType:"json",contentType:"application/json;charset=utf-8",success:function(i){$("#myAssignModal").modal("hide");if(h){$("#"+h).DataTable().ajax.reload()}}})}};$(function(){var e=[];var c=[];var d=[];var b=$("#myAssignType").val();var a=$("#myUserTable");$("#myAssignModal").on("show.bs.modal",function(){a.DataTable().ajax.url(base+"/admin/usercenter/user/nosearch").load();$.getJSON(base+"/admin/usercenter/role/organization/findAllOrgTypes",function(g){var h=g.returnObject;for(var f=0;f<h.length;f++){e.push({id:h[f].id,text:h[f].name,data:h[f],parent:(h[f].parentId?h[f].parentId:"#")})}$("#user_jstree_organization").jstree({core:{data:e}});$("#user_jstree_organization").on("loaded.jstree",function(j,i){$("#user_jstree_organization").jstree("open_all")});$("#user_jstree_organization").on("changed.jstree",function(j,i){a.DataTable().ajax.url(base+"/admin/usercenter/role/organization/search?typeParentId="+i.node.data.oaId+"&assignType="+b+"&assignId="+$("#myAssignId").val()).load()})});$.getJSON(base+"/admin/usercenter/user/findAllPosts",function(h){var f=h.returnObject;for(var g=0;g<f.length;g++){c.push({id:f[g].code,text:f[g].label,data:f[g],parent:(f[g].parentId?f[g].parentId:"#")})}$("#user_jstree_postTypes").jstree({core:{data:c}});$("#user_jstree_postTypes").on("loaded.jstree",function(j,i){$("#user_jstree_postTypes").jstree("open_all")});$("#user_jstree_postTypes").on("changed.jstree",function(j,i){a.DataTable().ajax.url(base+"/admin/usercenter/post/user/search?typeId="+i.node.data.id+"&assignType="+b+"&assignId="+$("#myAssignId").val()).load()})})})});