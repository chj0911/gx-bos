var closeFindCourse=function(){var $myCourseTable=$("#myCourseTable"),findCourseParam,oldCourseIds=$("#oldCourseIds").val();var findCourseId=$("#findCourseId").val(),findCourseType=$("#findCourseType").val(),findCourseParentTableId=$("#findCourseParentTableId").val();var findCourseRow=$("#course_multiselect_to option");if(!findCourseRow||findCourseRow.length==0){ModalBox.alert("请选择一条数据");return}if($("#findCourseCallback").val()){var param=new Array();for(var i=0;i<findCourseRow.length;i++){var item={value:findCourseRow[i].value,name:findCourseRow[i].text};param.push(item)}eval($("#findCourseCallback").val()).call(null,param);$("#findCourse").modal("hide");return}var findCourseList=new Array();for(var i=0;i<findCourseRow.length;i++){findCourseList.push(findCourseRow[i].value)}if(oldCourseIds!=null&&oldCourseIds!=""){findCourseParam={relationIds:findCourseList,id:findCourseId,olds:oldCourseIds}}else{findCourseParam={relationIds:findCourseList,id:findCourseId}}var url=base+"/admin";if(findCourseType=="plan"){url=url+"/studycenter/"+findCourseType+"/saveCourse"}else{if(findCourseType=="app_info"){$("#findCourse").modal("hide")}}$.ajax({type:"post",url:url,data:JSON.stringify(findCourseParam),dataType:"json",contentType:"application/json;charset=utf-8",success:function(response){$("#findCourse").modal("hide");if(findCourseParentTableId){$("#div-"+findCourseParentTableId).show();$("#"+findCourseParentTableId).DataTable().ajax.reload()}}})};$(function(){var a=[];var c=$("#findCourseType").val();var b=$("#myCourseTable");$("#findCourse_search").click(function(){var h=$("#coursetype_jstree_group");var f=h.jstree().get_selected();var g=$("#course_multiselect_to option");var k=new Array();if(g&&g.length>0){for(var e=0;e<g.length;e++){k.push(g[e].value)}}var d=base+"/admin/coursecenter/course_category/course/search";if(f&&f.length>0){var j={selectId:f[0],relationType:c,relationId:$("#findCourseId").val(),selectedList:k,courseTerminal:$("#courseTerminal").val(),queryThing:$("#findCourse_name").val()};$.ajax({type:"post",url:d,data:JSON.stringify(j),dataType:"json",contentType:"application/json;charset=utf-8",success:function(l){$("#course_multiselect").empty();var n=$("#course_multiselect");var o="";for(var m=0;m<=l.content.length-1;m++){o+="<option value='"+l.content[m].id+"'>"+l.content[m].name+"</option>"}n.append(o)}})}});$("#findCourse").on("show.bs.modal",function(){$("#course_multiselect").empty();$("#course_multiselect_to").empty();$("#findCourse_name").val("");$.getJSON(base+"/admin/coursecenter/course_category/searchCourseCategory",function(e){var f=e.returnObject;for(var d=0;d<f.length;d++){a.push({id:f[d].id,text:f[d].name,data:f[d],parent:(f[d].parentId?f[d].parentId:"#"),state:{opened:f[d].parentId?false:true}})}$("#coursetype_jstree_group").jstree({core:{data:a}});$("#coursetype_jstree_group").on("changed.jstree",function(l,j){var g=base+"/admin/coursecenter/course_category/course/search";var k=$("#course_multiselect_to option");var n=new Array();if(k&&k.length>0){for(var h=0;h<k.length;h++){n.push(k[h].value)}}var m={selectId:j.node.data.id,relationType:c,relationId:$("#findCourseId").val(),selectedList:n,courseTerminal:$("#courseTerminal").val(),queryThing:$("#findCourse_name").val()};$.ajax({type:"post",url:g,data:JSON.stringify(m),dataType:"json",contentType:"application/json;charset=utf-8",success:function(o){$("#course_multiselect").empty();var q=$("#course_multiselect");var r="";for(var p=0;p<=o.content.length-1;p++){r+="<option value='"+o.content[p].id+"'>"+o.content[p].name+"</option>"}q.append(r)}})})});$("#course_multiselect").multiselect()})});